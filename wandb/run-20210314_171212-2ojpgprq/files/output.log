  0%|                                                                               | 0/21 [00:00<?, ?it/s]  5%|███▍                                                                   | 1/21 [00:01<00:21,  1.08s/it] 10%|██████▊                                                                | 2/21 [00:02<00:19,  1.04s/it] 14%|██████████▏                                                            | 3/21 [00:03<00:17,  1.01it/s] 19%|█████████████▌                                                         | 4/21 [00:03<00:16,  1.05it/s] 24%|████████████████▉                                                      | 5/21 [00:04<00:15,  1.05it/s] 29%|████████████████████▎                                                  | 6/21 [00:05<00:14,  1.06it/s] 33%|███████████████████████▋                                               | 7/21 [00:06<00:12,  1.09it/s] 38%|███████████████████████████                                            | 8/21 [00:07<00:11,  1.10it/s] 43%|██████████████████████████████▍                                        | 9/21 [00:08<00:11,  1.05it/s] 48%|█████████████████████████████████▎                                    | 10/21 [00:09<00:10,  1.07it/s] 52%|████████████████████████████████████▋                                 | 11/21 [00:10<00:09,  1.03it/s] 57%|████████████████████████████████████████                              | 12/21 [00:11<00:08,  1.02it/s] 62%|███████████████████████████████████████████▎                          | 13/21 [00:12<00:08,  1.04s/it] 67%|██████████████████████████████████████████████▋                       | 14/21 [00:13<00:07,  1.02s/it] 71%|██████████████████████████████████████████████████                    | 15/21 [00:14<00:06,  1.02s/it] 76%|█████████████████████████████████████████████████████▎                | 16/21 [00:15<00:05,  1.03s/it] 81%|████████████████████████████████████████████████████████▋             | 17/21 [00:16<00:04,  1.04s/it] 86%|████████████████████████████████████████████████████████████          | 18/21 [00:17<00:03,  1.04s/it] 90%|███████████████████████████████████████████████████████████████▎      | 19/21 [00:18<00:01,  1.04it/s] 95%|██████████████████████████████████████████████████████████████████▋   | 20/21 [00:19<00:00,  1.09it/s]100%|██████████████████████████████████████████████████████████████████████| 21/21 [00:20<00:00,  1.13it/s]100%|██████████████████████████████████████████████████████████████████████| 21/21 [00:20<00:00,  1.04it/s]
  0%|                                                                               | 0/30 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████| 30/30 [00:00<00:00, 306.50it/s]
  0%|                                                                               | 0/21 [00:00<?, ?it/s] 19%|█████████████▌                                                         | 4/21 [00:00<00:00, 32.72it/s] 38%|███████████████████████████                                            | 8/21 [00:00<00:00, 32.85it/s] 57%|████████████████████████████████████████                              | 12/21 [00:00<00:00, 32.91it/s] 76%|█████████████████████████████████████████████████████▎                | 16/21 [00:00<00:00, 32.92it/s] 95%|██████████████████████████████████████████████████████████████████▋   | 20/21 [00:00<00:00, 32.98it/s]100%|██████████████████████████████████████████████████████████████████████| 21/21 [00:00<00:00, 32.92it/s]
  0%|                                                                               | 0/30 [00:00<?, ?it/s]100%|████████████████████████████████████████████████████████████████████| 30/30 [00:00<00:00, 9848.10it/s]
using GPU
Traceback (most recent call last):
  File "train.py", line 158, in <module>
    train()
  File "/home/cdminix/anaconda3/lib/python3.7/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/home/cdminix/anaconda3/lib/python3.7/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/home/cdminix/anaconda3/lib/python3.7/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/cdminix/anaconda3/lib/python3.7/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "train.py", line 96, in train
    h = model.init_hidden(batch_size)
  File "/home/cdminix/Documents/MLP/drought/lstm.py", line 48, in init_hidden
    weight.new(self.n_layers, batch_size, self.hidden_dim).zero_().to(device),
NameError: name 'device' is not defined
